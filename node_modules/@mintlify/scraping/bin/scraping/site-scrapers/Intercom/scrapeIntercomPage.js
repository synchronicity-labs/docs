import cheerio from 'cheerio';
import { NodeHtmlMarkdown } from 'node-html-markdown';
import downloadAllImages from '../../downloadAllImages.js';
import replaceImagePaths from '../../replaceImagePaths.js';
export async function scrapeIntercomPage(html, origin, cliDir, imageBaseDir, overwrite, _ // version
) {
    const $ = cheerio.load(html);
    const titleComponent = $('.t__h1').first();
    const title = titleComponent.text().trim();
    const description = $('.article__desc', titleComponent.parent()).text().trim();
    const content = $('article').first();
    const contentHtml = $.html(content);
    const origToWritePath = await downloadAllImages($, content, origin, imageBaseDir, overwrite, undefined);
    const nhm = new NodeHtmlMarkdown({ useInlineLinks: false });
    let markdown = nhm.translate(contentHtml);
    // Keep headers on one line
    markdown = markdown.replace(/# \n\n/g, '# ');
    // Remove unnecessary nonwidth blank space characters
    markdown = markdown.replace(/\u200b/g, '');
    // Reduce unnecessary blank lines
    markdown = markdown.replace(/\n\n\n/g, '\n\n');
    // Mintlify doesn't support bolded headers, remove the asterisks
    markdown = markdown.replace(/(\n#+) \*\*(.*)\*\*\n/g, '$1 $2\n');
    if (origToWritePath) {
        markdown = replaceImagePaths(origToWritePath, cliDir, markdown);
    }
    return { title, description, markdown };
}
//# sourceMappingURL=scrapeIntercomPage.js.map